# Definition of Done (DoD) - 完了の定義

**プロジェクト**: ミエルボード for 現場 / 現場WEEK  
**最終更新**: 2025-12-07

---

## 🎯 目的

「このタスク、完了でいいですか？」を **客観的に判断できる基準** を明確にします。

---

## ✅ 完了の定義（全タスク共通）

以下の **すべて** を満たすものを「Done」とみなします。

### 1. 📋 Issue・タスクとの紐付け

- [ ] **Plane Issue** または **GitHub Issue** と紐づいている
- [ ] PRタイトルに Issue番号が入っている（例: `feat: 週間ボード実装 (WBS-12)`）

---

### 2. 📐 仕様との整合性

- [ ] **SSOT（仕様ドキュメント）** との乖離がない
- [ ] 要件IDとAccept条件を満たしている
- [ ] PRに「参照SSOT」のリンクを記載

---

### 3. 🛡️ .cursorrules 準拠

- [ ] スキーマ変更をしていない、または（変更した場合）管理AI承認と影響範囲修正が揃っている
- [ ] 生SQLを使っていない（Prisma ORMのみ使用）
- [ ] マルチテナント原則を守っている（`organizationId` でフィルタ）
- [ ] `tenant_id ?? 'default'` のようなフォールバック禁止

---

### 4. 🤖 CI/CD通過

- [ ] **CIが全グリーン**
  - `lint-and-typecheck` ✅
  - `build` ✅
  - `security` ✅
  - `ssot-compliance` ✅
- [ ] PR に CI Run URL を記載

---

### 5. 🧪 テスト

- [ ] **必須レベル**の機能にはテストがある（[TEST_STRATEGY.md](./TEST_STRATEGY.md) 参照）
  - 認証・認可
  - マルチテナント境界
  - 金銭計算・プラン判定
  - Schedule CRUD
- [ ] `npm run test` がローカルでグリーン
- [ ] PRに「どのテストで何を検証したか」を記載

---

### 6. 📝 ドキュメント更新

- [ ] 仕様変更があれば、対応する SSOT を更新
- [ ] 新しいAPI・コンポーネントがあれば、必要に応じて `docs/` に追記
- [ ] README や設定ガイドに影響があれば更新

---

### 7. 🔍 証跡（Evidence）

- [ ] **実行コマンド + 生ログ** を PR に貼る
  - 例: `npm run test` の出力
  - 例: `curl` でAPIを叩いた結果
- [ ] スクリーンショットや動画（UIの場合）
- [ ] 「動作確認しました」だけはNG

---

### 8. 👥 レビュー

- [ ] PR レビュアーをアサイン
- [ ] レビュアーの承認を得る
- [ ] 指摘事項があれば修正してコミット

---

## 🚫 「Done」とみなさない例

以下のような状態は **未完了** です：

❌ 「とりあえず動いたのでマージします」  
❌ 「CIは赤いけど、後で直します」  
❌ 「テストは時間がなくて書けませんでした」  
❌ 「仕様書は後で更新します」  
❌ 「organizationId のフィルタ、後で追加します」  

---

## 📊 DoD チェックリスト（PR作成時）

PRを作成するときは、以下をコピペして埋めてください：

```markdown
## ✅ DoD チェックリスト

- [ ] Issue・タスクと紐付け（WBS-XX）
- [ ] SSOT との整合性確認
- [ ] .cursorrules 準拠
  - [ ] スキーマ変更なし
  - [ ] 生SQL禁止
  - [ ] マルチテナント原則
- [ ] CI 全グリーン
- [ ] テスト追加・実行済み
- [ ] ドキュメント更新済み
- [ ] 証跡（コマンド + ログ）添付
- [ ] レビュー依頼済み
```

---

## 🎯 レベル別 DoD（オプション）

プロジェクトの成熟度に応じて、DoDを段階的に強化できます。

### Level 1: 最低限（Phase 0）

- Issue紐付け
- CI通過
- .cursorrules 準拠

### Level 2: 標準（Phase 1）

- Level 1 +
- テスト必須
- ドキュメント更新

### Level 3: 厳格（Phase 2以降）

- Level 2 +
- カバレッジ80%以上
- E2Eテスト必須（クリティカルパス）
- パフォーマンス検証

---

## 🔗 関連ファイル

- `.github/PULL_REQUEST_TEMPLATE.md` - PRテンプレート
- `docs/TEST_STRATEGY.md` - テスト戦略
- `docs/BRANCH_AND_RELEASE.md` - ブランチ戦略
- `.cursorrules` - AI制御ルール




